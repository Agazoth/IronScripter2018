if(([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]'Administrator')){(Get-WinEvent -ListLog * -ea 0 -Force).where{$_.RecordCount -gt 0}.foreach{if ($_.filesize/$_.MaximumSizeInBytes -gt 0.8){if ($_.LogMode -ne "Circular"){ $_.LogMode="Circular"}; $_.MaximumSizeInBytes=([math]::ceiling($_.MaximumSizeInBytes*1.1/64)*64);$_.SaveChanges(); 'EventLog {0} increased to {1} bytes. Logmode: {2}' -f  $_.LogName,([math]::ceiling($_.MaximumSizeInBytes*1.1/64)*64),$_.LogMode | out-file $PSScriptRoot\EventlogFix.log -Append};$_} | select LogName ,RecordCount | sort RecordCount -Descending} else {Write-Warning "You must be an admin to run this script"}